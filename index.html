<!DOCTYPE html>
<html>
  <head>
    <title>Notes Configuration</title>
  </head>
  <body>
    <h1>Notes Configuration</h1>
    <p>Your notes:</p>

	<form>
	  <textarea id="notes" cols="25" rows="5"></textarea>
	</form>

    <p>
      <button id="clear_button">Clear</button>
      <button id="save_button">Save</button>
    </p>

    <script>
      var notes = document.getElementById("notes");
      
      function saveOptions() {
      	var notesText = notes.value;
        var options = {
          "notes": notesText,
          "notesLength": notesText.length
        };
        var JSONOptions = JSON.stringify(options);
        localStorage.lastNotes = JSONOptions;
        return JSONOptions;
      }
      
      var notesInStorage = localStorage.lastNotes;
      if (notesInStorage !== undefined) {
      	notes.value = JSON.parse(notesInStorage).notes;
      }
      
      var clearButton = document.getElementById("clear_button");
      clearButton.addEventListener("click",
        function () {
          notes.value = "";
        },
        false
      );
      
      var submitButton = document.getElementById("save_button");
      submitButton.addEventListener("click", 
        function () {
          document.location = "pebblejs://close#" + encodeURIComponent(saveOptions());
        },
        false
      );
    </script>
  </body>
</html>