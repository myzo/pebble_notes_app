<!DOCTYPE html>
<html>
  <head>
  	<style>
  	  body {
  		text-align: center;
  		background-color: #eeffee;
  	  }
  	  
  	  #content {
  	  	height: 430px;
  	  	padding: 2px;
  	  	background-color: #f1f1f1;
  	  }
  	  
  	  #notes {
  	  	resize: none;
  	  	background-color: #f1f1f1;
  	  }
  		
  	  button {
  		width: 80px;
  		height: 30px;
   	  }
  	</style>
  	
    <title>Notes</title>
  </head>
  <body>
  	
  	<div id="content">
      <h1>Configuration</h1>
      <p>Your notes:</p>

	  <form>
	    <textarea id="notes" cols="18" rows="15"></textarea>
	  </form>

      <p>
        <button id="clear_button">Clear</button>
        <button id="save_button">Save</button>
      </p>
    </div>

    <script>
      var notes = document.getElementById("notes");
      
      var notesInStorage = localStorage.lastNotes;
      if (notesInStorage !== undefined) {
      	notes.value = JSON.parse(notesInStorage).notes;
      }
      
      function saveOptions() {
      	var notesText = notes.value;
        var options = {
          "notes": notesText,
          "notesLength": notesText.length
        };
        var JSONOptions = JSON.stringify(options);
        localStorage.lastNotes = JSONOptions;
        return JSONOptions;
      }
      
      var clearButton = document.getElementById("clear_button");
      clearButton.addEventListener("click",
        function () {
          notes.value = "";
        },
        false
      );
      
      var submitButton = document.getElementById("save_button");
      submitButton.addEventListener("click", 
        function () {
          document.location = "pebblejs://close#" + encodeURIComponent(saveOptions());
        },
        false
      );
    </script>
  </body>
</html>